package com.ao.co.tobe.solucaotpe.views_models.print


import android.content.Context
import android.graphics.BitmapFactory
import android.util.Base64
import android.util.Log
import android.widget.Toast
import com.ao.co.tobe.appbuap.controllers.deviceEng
import com.ao.co.tobe.appbuap.models.MovimentosModel
import com.nexgo.oaf.apiv3.SdkResult
import com.nexgo.oaf.apiv3.device.printer.AlignEnum
import com.nexgo.oaf.apiv3.device.printer.OnPrintListener
import com.nexgo.oaf.apiv3.device.printer.Printer
import com.nexgo.oaf.apiv3.device.printer.DotMatrixFontEnum
import com.nexgo.oaf.apiv3.device.printer.FontEntity
import com.nexgo.oaf.apiv3.device.printer.LineOptionEntity
import java.text.DecimalFormat
import java.text.DecimalFormatSymbols
import java.text.SimpleDateFormat
import java.util.Calendar
import java.util.Locale

class TicketPagmentPrint() : OnPrintListener {
    var  imagem: String = ",Qk26LgAAAAAAAD4AAAAoAAAACwIAAK8AAAABAAEAAAAAAAAAAADEDgAAxA4AAAIAAAACAAAAHh4e//39/f///////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD///////+AAAAAAAf/////8AAAAAAAH////////////////////////////////////////////////////////+AAAP///////gAAAAAADf/////wAAAAAAA/////////////////////////////////////////////////////////4AAA///////+AAAAAAAcf////+AAAAAAAD/////////////////////////////////////////////////////////gAAD///////wAAAAAABw/////4AAAAAAAP////////////////////////////////////////////////////////+AAAP///////AAAAAAAHA/////gAAAAAAB/////////////////////////////////////////////////////////4AAA///////8AAAAAAAcB////8AAAAAAAH/////////////////////////////////////////////////////////gAAD///////wAAAAAABwD////wAAAAAAAf////////////////////////////////////////////////////////+AAAP///////AAAAAAAHAH////AAAAAAAD/////////////////////////////////////////////////////////4AAA///////8AAAAAAAMAH///4AAAAAAAP/////////////////////////////////////////////////////////gAAD///////wAAAAAAA4AP///gAAAAAAB/////////////////////////////////////////////////////////+AAAP///////gAAAAAABgAf//+AAAAAAAH/////////////////////////////////////////////////////////4AAA///////+AAAAAAAGAA///wAAAAAAAf/////////////////////////////////////////////////////////gAAD///////4AAAAAAAcAA///AAAAAAAD/////////////////////////////////////////////////////////+AAAP///////wAAAAAAAwAB//8AAAAAAAP/////////////////////////////////////////////////////////4AAA////////AAAAAAADgAD//gAAAAAAA//////////////////////////////////////////////////////////gAAD///////8AAAAAAAOAAH/+AAAAAAAH/////////////////////////////////////////////////////////+AAAP///////4AAAAAAAYAAH/4AAAAAAAf/////////////////////////////////////////////////////////4AAA////////gAAAAAABwAAP/AAAAAAAD//////////////////////////////////////////////////////////gAAD///////+AAAAAAAHAAAf8AAAAAAAP/////////////////////////////////////////////////////////+AAAP///////8AAAAAAAMAAAfwAAAAAAA//////////////////////////////////////////////////////////4AAA////////wAAAAAAA4AAA+AAAAAAAH//////////////////////////////////////////////////////////gAAD////////gAAAAAADgAAB8AAAAAAAf/////////////////////////////////////////////////////////+AAAP///////+AAAAAAAGAAAB8AAAAAAB//////////////////////////////////////////////////////////4AAA////////4AAAAAAAcAAAD4AAAAAAP//////////////////////////////////////////////////////////gAAD////////wAAAAAABwAAAHwAAAAAA///gAP/wAAAAAAD///z///wAD/////+AAH//+AAAAAOAA/+AAAD///////+AAAP////////AAAAAAADAAAAHwAAAAAD///gB//gAAPAAA///+P//4AAA////+AAAD//+AAAAAeAH/+AAA////////4AAA////////8AAAAAAAOAAAAPgAAAAAf///gP//AAD/AAH///x//+AAAAf///gAAAB//8AAAAB+A//8AAP////////gAAD////////4AAAAAAA4AAAAPgAAAAB////A//8AAf8AA///+H//gAfgAf//4AH8AD//4AAAAH8D//wAB////////+AAAP////////gAAAAAABgAAAAfAAAAAP///+D//wAB/4AD///wf/8AH/gA///AA/8AD//gAP/AfwP//AAH////////4AAA////////+AAAAAAAHAAAAAfAAAAA////4P/+AAP/gAP//8B//gA//AA//4AH/4AH/+AA//B/g//4AA/////////gAAD////////8AAAAAAAcAAAAA+AAAAD////gf/4AA/+AA///gH/8AH/8AB//AA//wAP/4AD/+H+B//gAD////////+AAAP////////wAAAAAAAwAAAAB+AAAAf////B//gAH/4AD//8Af/gAf/wAH/4AH//gAf/gAP/8P8H/8AAf////////4AAA/////////AAAAAAADgAAAAB8AAAB////8D/8AAf/gAP//gB/8AD//AAf/AAf/+AA/+AA//4/wP/wAB/////////gAAD////////+AAAAAAAOAAAAAD8AAAH////4AAAAD/+AA//8AH/wAP/8AB/8AD//8AD/4AD//z/gAAAAP////////+AAAP////////4AAAAAAAYAAAAAH8AAA/////gAAAAP/4AD//AAf+AA//wAH/gAP//wAH/gAP//P+AAAAA/////////4AAA/////////wAAAAAABwAAAAAH4AAD/////AAAAB//gAP/4AB/4AH//AAf+AB///AAf+AA//+/8AAAAH/////////gAAD/////////AAAAAAAHAAAAAAH4AAf////8D/AAH/+AA//AAH/AAf/8AB/wAH//+AA/4AD//7/wf8AAf////////+AAAP////////8AAAAAAAMAAAAAAP4AB/////4P8AA//4AD/4AAf8AB//wAH/AAf//4AD/gAP//v/g/wAD/////////4AAA/////////4AAAAAAA4AAAAAAP4AH/////g/gAD//gAP/AAB/wAH//AAf8AB///gAP+AA////+D+AAP/////////gAAD/////////gAAAAAADgAAAAAAH4A//////B+AAf/+AA/wAAH+AAf/8AB/gAH//+AAf4AD////4H4AB/////////+AAAP////////+AAAAAAAH////////4D/////8H4AB//4AD+AAAf4AB//wAH+AAf//4AB/gAP////wfAAH/////////4AAA/////////8AAAAAAAf////////4P/////4PAAP//gAPwAAB/gAH//AAf4AB///gAH+AA/////B8AA//////////gAAD/////////wAAAAAAB/////////9//////g8AA//+AA+AQAH+AAf/4AA/gAH//+AAf4AD////+DwAD/////////+AAAP/////////AAAAAAAD/+AAAAAAAH/////+DgAH//4ADwDAAf4AB/+AAA+AA///4AB/gAP////4OAAf/////////4AAA/////////+AAAAAAAP/4AAAAAAAf/////8GAAf//gAOAcAB/gAH/////4AD///gAH+AA/////wYAB//////////gAAD/////////4AAAAAAA//AAAAAAAD//////wQAD//+AAgDwAH+AAf/////gAP//+AAf4AD/////BAAP/////////+AAAP/////////gAAAAAAB/8AAAAAAAP//////gAAP//4AAAfAAf4AB/////+AAf//4AB/gAP////+AAA//////////4AAA//////////AAAAAAAH/wAAAAAAB//////+AAB///gAAH8AB/gAH/////4AB///gAH+AA/////4AAH//////////gAAD/////////8AAAAAAAf+AAAAAAAH//////8AAH//+AAA/wAH+AAf/////gAH//+AAf4AD/////wAAf/////////+AAAP/////////4AAAAAAA/4AAAAAAAf//////wAAf//4AAH/AAf4AB/////+AAf//4AD/gAP/////AAD//////////4AAA//////////gAAAAAAD/gAAAAAAD///////gAD///gAA/8AB/wAH/////8AB///gAP+AA/////+AAP//////////gAAD/////////+AAAAAAAP8AAAAAAAP//////+AAP//+AAH/wAH/AAf/////wAH//+AA/4AD/////4AB//////////+AAAP/////////8AAAAAAAfwAAAAAAA///////8AB///4AB//AAf8AA///+//AAf//wAD/gAP/////gAH//////////4AAA//////////wAAAAAAB/AAAAAAAH///////wAH///gAP/8AB/4AD///z/+AA///AAf+AA//////AA///////////gAAD//////////AAAAAAAH4AAAAAAAf///////gA///+AB//wAH/gAP///P/4AD//8AB/4AD/////8AD//////////+AAAP/////////+AAAAAAAPgAAAAAAB///////+AD///4AP//AAf/AAf//4//wAP//gAP/gAP/////4Af//////////4AAA//////////4AAAAAAA+AAAAAAAP///////4Af///gB//8AB/8AB///j//AAf/+AB/+AA//////gB///////////gAAD//////////gAAAAAADwAAAAAAA////////wB///+AP//wAH/4AD//8P/+AB//wAH/4AD//////AP//////////+AAAP//////////AAAAAAAHAAAAAAAH////////AP///4D///AAf/wAP//g//8AD//AA//gAP/////8A///////////4AAA//////////8AAAAAAAcAAAAAAAf///////+A////gf//8AB//gAP/8D//4AH/4AH/+AA//////4H///////////gAAD//////////wAAAAAABgAAAAAAB////////4H///+D///wAH//AAf/AP//wAP/AB//4AD//////gf//////////+AAAP//////////gAAAAAACAAAAAAAP////////wf///wf///AAf/+AAPwA///wAPgAP//gAP//////D///////////4AAA//////////+AAAAAAAAAAAAAAA/////////D////D///4AA//+AAAAD///wAAAD//8AAf/////8P///////////gAAD//////////8AAAAAAAAAAAAAAD////////+P///8///8AAAP//AAAB////wAAB//+AAAP/////w///////////+AAAP//////////wAAAAAAAAAAAAAAf////////5////3//////////wAH/////+AB/////////////n///////////4AAA///////////AAAAAAAAAAAAAAB/////////n//////////////////////////////////////+f///////////gAAD//////////+AAAAAAAAAAAAAAP////////////////////////////////////////////////////////////+AAAP//////////4AAAAAAAAAAAAAA/////////////////////////////////////////////////////////////4AAA///////////gAAAAAAAAAAAAAD/////////////////////////////////////////////////////////////gAAD///////////AAAAAAAAAAAAAAf////////////////////////////////////////////////////////////+AAAP//////////8AAAAAAAAAAAAAB/////////////////////////////////////////////////////////////4AAA///////////wAAAAAAAAAAAAAH/////////////////////////////////////////////////////////////gAAD///////////gAAAAAAAAAAAAA/////////////////////////////////////////////////////////////+AAAP//////////+AAAAAAAAAAAAAD/////////8A///4B//////8AB/8B+D/Af+//+Af////4AP//gAP//////////4AAA///////////8AAAAAAAAAAAAAP/////////Dw//+Hh///n//4AH/4Pg/+D/z//h4f////wAH//AA///////////gAAD///////////wAAAAAAAAAAAAB/////////4fh//h/D//+f//w/P/g8H/4f+P/8P4f////D8P/8Hz//////////+AAAP///////////AAAAAAAAAAAAAH/////////D/D/8H+H//w///D+/+Dwf/h/w//h/g////8P4f/wfv//////////4AAA///////////+AAAAAAAAAAAAA/////////4f8P/w/8P//D//8P7/4OD/+H+D/8H/D////w/w//B/f//////////gAAD///////////4AAAAAAAAAAAAD/////////h/w/+D/w//4H//w///g4f/4fwP/w/8H////D/B/8H///////////+AAAP///////////gAAAAAAAAAAAAP////////+H/D/4P/B//gf//D//+DB//h+A//D/4f///8P8H/wf///////////4AAA////////////AAAAAAAAAAAAB/////////wf8P/h/8H/8E//8Pf/4MP/+HhD/4P/h////w/4f/B7///////////gAAD///////////8AAAAAAAAAAAAH/////////B///+H/wf/wz//wB//gg//4cMP/g/+H////D/h/8AP//////////+AAAP///////////wAAAAAAAAAAAAf////////8H///4f/B/+Dn//D3/+Dh//hhw/+D/4f///8P+H/wc///////////4AAA////////////gAAAAAAAAAAAD/////////wf///h/8H/4ef/8P//4PD/+EfD/4P/h////w/4f/B7///////////gAAD///////////+AAAAAAAAAAAAP/////////h///+D/w//B5//w///g8P/4D8P/w/8H////D/B/8H///////////+AAAP///////////4AAAAAAAAAAAB/////////+H/3/8P/D/8Hz//D//+Dw//gfw//D/w////8P8P/wf///////////4AAA////////////wAAAAAAAAAAAH/////////4P/f/w/4f/g/P/8P//4PD/+D/D/+H/D////w/g//B////////////gAAD////////////AAAAAAAAAAAAf/////////w/5//h/h/+D+f/w/f/g8P/4f8P/4f4f////D+H/8H///////////+AAAP///////////+AAAAAAAAAAAD//////////g/H//D4P/wf5//D5/+DB//j/w//wfD////8Pg//wff//////////4AAA////////////4AAAAAAAAAAAP//////////gA///AD/+A/j/4AH/4AP/+f+B//wA/////gAP//AB///////////gAAD////////////gAAAAAAAAAAA///////////5////z/////////////////////8///////////////////////+AAAP////////////AAAAAAAAAAAH//////////////////////////////////////////////////////////////4AAA////////////8AAAAAAAAAAAf//////////////////////////////////////////////////////////////gAAD////////////wAAAAAAAAAAB//////////////////////////////////////////////////////////////+AAAP////////////gAAAAAAAAAAP//////////////////////////////////////////////////////////////4AAA////////////+AAAAAAAAAAA///////////////////////////////////////////////////////////////gAAD////////////4AAAAAAAAAAH//////////////////////////////////////////////////////////////+AAAP////////////wAAAAAAAAAAf//////////////////////////////////////////////////////////////4AAA/////////////AAAAAAAAAAB///////////////////////////////////////////////////////////////gAAD////////////+AAAAAAAAAAP//////////////////////////////////////////////////////////////+AAAP////////////4AAAAAAAAAA///////////////////////////////////////////////////////////////4AAA/////////////gAAAAAAAAAD///////////////////////////////////////////////////////////////gAAD/////////////AAAAAAAAAAf//////////////////////////////////////////////////////////////+AAAP////////////8AAAAAAAAAB///////////////////////////////////////////////////////////////4AAA/////////////wAAAAAAAAAH///////////////////////////////////////////////////////////////gAAD/////////////gAAAAAAAAA///////////////////////////////////////////////////////////////+AAAP////////////+AAAAAAAAAD///////////////////////////////////////////////////////////////4AAA/////////////4AAAAAAAAAf///////////////////////////////////////////////////////////////gAAD/////////////wAAAAAAAAB///////////////////////////////////////////////////////////////+AAAP/////////////AAAAAAAAAH///////////////////////////////////////////////////////////////4AAA/////////////+AAAAAAAAA////////////////////////////////////////////////////////////////gAAD/////////////4AAAAAAAAD///////////////////////////////////////////////////////////////+AAAP/////////////wAAAAAAAAf///////////////////////////////////////////////////////////////4AAA//////////////gAAAAAAAD////////////////////////////////////////////////////////////////gAAD/////////////////////9////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAP//////////////////////////////////////////////////////////////////////////////////////4AAA///////////////////////////////////////////////////////////////////////////////////////gAAD//////////////////////////////////////////////////////////////////////////////////////+AAAA=="
    lateinit var printer: Printer
    val calendar = Calendar.getInstance().time
    var dateTimeFormat = SimpleDateFormat("dd-MM-yyyy HH:mm:ss", Locale.getDefault())
    private var decimalFormat : DecimalFormat = DecimalFormat("#,###.00", DecimalFormatSymbols.getInstance(
        Locale.GERMAN))
    fun printReceipt(context: Context, idOperation: String, numCard: String, montante: String, pago:String,troco:String, tipo:String) {
        printer = deviceEng!!.printer
        printer.initPrinter()

        val tvDateTime = dateTimeFormat.format(calendar)
        val valor: Boolean = when (printer.status) {
            SdkResult.Success -> {
                Log.d("Printer","true")
                true
            }
            SdkResult.Printer_PaperLack -> {
                Log.d("Printer","false")
                false
            }
            else -> {
                Log.d("Printer"," else false")
                false
            }
        }
        val receiptLogo = Base64.decode(imagem, 0)
        val image = BitmapFactory.decodeByteArray(receiptLogo, 0, receiptLogo.size)


        val dadosQRCode = "{\"Operacao\":\"${idOperation}\",\"Data\":\"${tvDateTime}\"}"


        printer.appendImage(image, AlignEnum.CENTER)
        printer.appendPrnStr(" ", 14, AlignEnum.CENTER, true)
        printer.appendPrnStr("N. Ordem:",idOperation, 24,  true)
        printer.appendPrnStr("Montante:","${decimalFormat.format(montante.toDouble())}AKZ", 24,  true)
        printer.appendPrnStr("Pago:","${decimalFormat.format(pago.toDouble())}AKZ", 24,  true)
        printer.appendPrnStr("Troco:","$troco AKZ", 24,  true)
        printer.appendPrnStr("\n", 24, AlignEnum.CENTER, true)
        printer.appendPrnStr("Local:","BUAP-Talatona", FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24),LineOptionEntity())
        printer.appendPrnStr("Pago por:",tipo, FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24),LineOptionEntity())
        printer.appendPrnStr("Data/Hora:",tvDateTime, FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24), LineOptionEntity())
        printer.appendPrnStr(" ", 24, AlignEnum.CENTER, true)
        printer.appendQRcode(dadosQRCode,150,AlignEnum.CENTER)

        if (valor)
        printer.startPrint(valor,this@TicketPagmentPrint)

        else
         Toast.makeText(context,"Verifica o Papel",Toast.LENGTH_LONG).show()
    }

    fun AtiveCardReceipt(numCard: String,vendedor:String,nif:String,operador:String,local:String) {
        printer = deviceEng!!.printer
        printer.initPrinter()

        val tvDateTime = dateTimeFormat.format(calendar)
        val valor: Boolean = when (printer.status) {
            SdkResult.Success -> true
            SdkResult.Printer_PaperLack -> {
                false
            }
            else -> false
        }
        val receiptLogo = Base64.decode(imagem, 0)
        val image = BitmapFactory.decodeByteArray(receiptLogo, 0, receiptLogo.size)


        printer.appendImage(image, AlignEnum.CENTER)
        printer.appendPrnStr(" ", 14, AlignEnum.CENTER, true)
        printer.appendPrnStr("Activar Cartão", 32, AlignEnum.CENTER,true)
        printer.appendPrnStr(" ", 24, AlignEnum.CENTER, true)
        printer.appendPrnStr("N. Cartão:",numCard, 24, true)
        printer.appendPrnStr("Nome:", " $vendedor", 24, true)
        printer.appendPrnStr("NIF:", nif,24, true)
        printer.appendPrnStr("\n", 24, AlignEnum.CENTER, true)
        printer.appendPrnStr("Data/Hora.:",tvDateTime, FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24),LineOptionEntity())
        printer.appendPrnStr("Operador.:",operador, FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24),LineOptionEntity())
        printer.appendPrnStr("Local:",local, FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24),LineOptionEntity())
        printer.startPrint(valor,this@TicketPagmentPrint)
    }

    fun fechoReceipt(context: Context,operacao:String, local:String,montante:String,operador:String,movimentos: List<MovimentosModel>) {
        printer = deviceEng!!.printer
        printer.initPrinter()
        //val date = LocalDate.parse(movimentos[0].DataMov, DateTimeFormatter.ISO_DATE)
        //var dateTimeFormat1 = SimpleDateFormat("dd-MM-yy HH:mm:ss", Locale.getDefault())

        val valor: Boolean = when (printer.status) {
            SdkResult.Success -> true
            SdkResult.Printer_PaperLack -> {
                false
            }
            else -> false
        }

        val tvDateTime = dateTimeFormat.format(calendar)
        val receiptLogo = Base64.decode(imagem, 0)
        val image = BitmapFactory.decodeByteArray(receiptLogo, 0, receiptLogo.size)


        printer.appendImage(image, AlignEnum.CENTER)
        printer.appendPrnStr("Fecho", 32, AlignEnum.CENTER,true)
        printer.appendPrnStr(" ", 24, AlignEnum.CENTER, true)
        printer.appendPrnStr("N. da operação:",operacao, 24, true)
        printer.appendPrnStr("Montante:", "${montante}0 AKZ", 24, true)
        printer.appendPrnStr("\n", 24, AlignEnum.CENTER, true)
        printer.appendPrnStr("Movimentos", 32, AlignEnum.LEFT,true)
        printer.appendPrnStr("\n", 24, AlignEnum.CENTER, true)
        for (m in movimentos){
            var data: List<String> = m.DataMov.split("T")
            var data2: List<String> = data[0].split("-")
            val dataFinal =  data2[2] + "-" + data2[1] +"-"+ data2[0] + " " + data[1]
            Log.d("DATA",dataFinal)
            if (m.NumeroRecibo != null) {
                printer.appendPrnStr("$dataFinal ", "${m.NumeroRecibo}", 24, true)
                printer.appendPrnStr("${m.DescricaoMov} ", "${m.Valor}0 AKZ", 24, true)
                printer.appendPrnStr("--------------------------------", 24, AlignEnum.CENTER, true)
            }
        }
        printer.appendPrnStr("\n", 24, AlignEnum.CENTER, true)
        printer.appendPrnStr("Data/Hora.:",tvDateTime, FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24),LineOptionEntity())
        printer.appendPrnStr("Operador.:",operador, FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24),LineOptionEntity())
        printer.appendQRcode("Vazia",150,AlignEnum.CENTER)
       // printer.appendPrnStr("Local:",local, FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24),LineOptionEntity())

        if (valor)
            printer.startPrint(valor,this@TicketPagmentPrint)
        else
            Toast.makeText(context,"Verifica o Papel",Toast.LENGTH_LONG).show()
    }


    fun registoRupeReceipt(context: Context,operacao:String,montante:String,operador:String) {
        printer = deviceEng!!.printer
        printer.initPrinter()

        val valor: Boolean = when (printer.status) {
            SdkResult.Success -> {
                Log.d("Printer","true")
                true
            }
            SdkResult.Printer_PaperLack -> {
                Log.d("Printer","false")
                false
            }
            else -> {
                Log.d("Printer"," else false")
                false
            }
        }

        val tvDateTime = dateTimeFormat.format(calendar)
        val receiptLogo = Base64.decode(imagem, 0)
        val image = BitmapFactory.decodeByteArray(receiptLogo, 0, receiptLogo.size)


        printer.appendImage(image, AlignEnum.CENTER)
        printer.appendPrnStr("Pagamento Rupe", 32, AlignEnum.CENTER,true)
        printer.appendPrnStr(" ", 24, AlignEnum.CENTER, true)
        printer.appendPrnStr("Rupe:",operacao, 24, true)
        printer.appendPrnStr("Montante:", "${montante}0 AKZ", 24, true)
        printer.appendPrnStr("\n", 24, AlignEnum.CENTER, true)
        printer.appendPrnStr("Data/Hora.:",tvDateTime, FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24),LineOptionEntity())
        printer.appendPrnStr("Operador.:",operador, FontEntity(DotMatrixFontEnum.ASC_MYuen_12X24),LineOptionEntity())

        if (valor)
            printer.startPrint(valor,this@TicketPagmentPrint)
        else
            Toast.makeText(context,"Verifica o Papel",Toast.LENGTH_LONG).show()
    }

    override fun onPrintResult(resultCode: Int) {
        try {
            when (resultCode) {
                SdkResult.Success ->{
                    Log.e("tags", "Sucesso: $resultCode")
                }
                SdkResult.Printer_Print_Fail -> Log.e("tags", "Printer Failed: $resultCode")
                SdkResult.Printer_Busy -> Log.e("tags", "Printer is Busy: $resultCode")
                SdkResult.Printer_PaperLack -> {

                }
                SdkResult.Printer_Fault -> {

                }
                SdkResult.Printer_TooHot -> Log.e(
                    "tags",
                    "Printer temperature is too hot: $resultCode"
                )
                SdkResult.Printer_UnFinished -> Log.w(
                    "tags",
                    "Printer job is unfinished: $resultCode"
                )
                SdkResult.Printer_Other_Error -> {

                }
                else -> Log.e("tags", "Generic Fail Error: $resultCode")
            }
        }catch (e: Exception){
            Log.e("tags", "falha: $e")
        }

    }
}